2025-07-01 05:13:18,591 - bris_handicapper.main - INFO - ==============================================
2025-07-01 05:13:18,592 - bris_handicapper.main - INFO - === Starting Brisnet Data Processing Pipeline ===
2025-07-01 05:13:18,592 - bris_handicapper.main - INFO - ==============================================
2025-07-01 05:13:18,592 - bris_handicapper.main - INFO - Searching for DRF files in: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\raw using pattern: '*.[dD][rR][fF]'
2025-07-01 05:13:18,594 - bris_handicapper.main - INFO - Found latest DRF file: CDX0628.DRF
2025-07-01 05:13:18,594 - bris_handicapper.main - INFO - Step 1: Parsing Brisnet data...
2025-07-01 05:13:18,595 - bris_handicapper.data_processing.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-07-01 05:13:18,595 - bris_handicapper.data_processing.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\raw\CDX0628.DRF
2025-07-01 05:13:18,596 - bris_handicapper.data_processing.bris_spec_new - INFO - Loading specification cache from: C:\Users\Larry\Documents\Bris\BrisHandicapper\cache\bris_spec.pkl
2025-07-01 05:13:18,614 - bris_handicapper.data_processing.bris_spec_new - INFO - Parsing field types from: C:\Users\Larry\Documents\Bris\BrisHandicapper\cache\bris_dict.txt
2025-07-01 05:13:18,638 - bris_handicapper.data_processing.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-07-01 05:13:18,639 - bris_handicapper.data_processing.bris_spec_new - INFO - 
Attempting to parse CDX0628.DRF as comma-delimited...
2025-07-01 05:13:18,640 - bris_handicapper.data_processing.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-07-01 05:13:18,823 - bris_handicapper.data_processing.bris_spec_new - INFO - Parsing successful. Read 110 lines from CDX0628.DRF.
2025-07-01 05:13:18,823 - bris_handicapper.data_processing.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-07-01 05:13:18,913 - bris_handicapper.data_processing.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-07-01 05:13:18,914 - bris_handicapper.data_processing.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-07-01 05:13:18,914 - bris_handicapper.data_processing.bris_spec_new - INFO - 
Attempting data type conversions...
2025-07-01 05:13:18,916 - bris_handicapper.data_processing.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-07-01 05:13:18,960 - bris_handicapper.data_processing.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-07-01 05:13:18,960 - bris_handicapper.data_processing.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-07-01 05:13:18,985 - bris_handicapper.data_processing.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-07-01 05:13:19,011 - bris_handicapper.data_processing.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\parsed_race_data_full.parquet
2025-07-01 05:13:19,351 - bris_handicapper.data_processing.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\parsed_race_data_full.parquet
2025-07-01 05:13:19,352 - bris_handicapper.data_processing.bris_spec_new - INFO - Final DataFrame shape: (110, 1332)
2025-07-01 05:13:19,352 - bris_handicapper.data_processing.bris_spec_new - INFO - Final DataFrame Info:
2025-07-01 05:13:19,352 - bris_handicapper.data_processing.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-07-01 05:13:19,355 - bris_handicapper.main - INFO - Step 2: Creating current race info...
2025-07-01 05:13:19,528 - bris_handicapper.data_processing.current_race_info - INFO - --- Creating Current Race Info File (2025-07-01 05:13:19 EDT) ---
2025-07-01 05:13:19,528 - bris_handicapper.data_processing.current_race_info - INFO - Loading wide format data from: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\parsed_race_data_full.parquet
2025-07-01 05:13:19,816 - bris_handicapper.data_processing.current_race_info - INFO - Loaded wide data with shape: (110, 1332)
2025-07-01 05:13:19,826 - bris_handicapper.data_processing.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-07-01 05:13:19,852 - bris_handicapper.data_processing.current_race_info - INFO - DataFrame shape after dropping columns: (110, 335)
2025-07-01 05:13:19,852 - bris_handicapper.data_processing.current_race_info - INFO - Number of columns actually dropped: 997
2025-07-01 05:13:19,854 - bris_handicapper.data_processing.current_race_info - INFO - 
Saving current race info data to: C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\current_race_info.parquet
2025-07-01 05:13:19,922 - bris_handicapper.data_processing.current_race_info - INFO - Save complete.
2025-07-01 05:13:19,922 - bris_handicapper.data_processing.current_race_info - INFO - 
Output DataFrame Info:
2025-07-01 05:13:19,923 - bris_handicapper.data_processing.current_race_info - INFO - 
--- Script Finished (2025-07-01 05:13:19 EDT) ---
2025-07-01 05:13:19,926 - bris_handicapper.main - INFO - Step 3: Transforming workouts...
2025-07-01 05:13:19,926 - bris_handicapper.data_processing.long_format_transformer - INFO - --- Transforming workout data ---
2025-07-01 05:13:20,131 - bris_handicapper.data_processing.long_format_transformer - INFO - Saved workout data to C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\workouts_long_format.parquet
2025-07-01 05:13:20,133 - bris_handicapper.main - INFO - Step 4: Transforming past starts...
2025-07-01 05:13:20,133 - bris_handicapper.data_processing.long_format_transformer - INFO - --- Transforming past performance data ---
2025-07-01 05:13:21,437 - bris_handicapper.data_processing.long_format_transformer - INFO - Calculating Brohamer/Sartin pace figures...
2025-07-01 05:13:21,443 - bris_handicapper.data_processing.long_format_transformer - WARNING - Required split column 'pp_split_4f_finish_secs' not found. Pace calculations involving it will result in NaN.
2025-07-01 05:13:21,444 - bris_handicapper.data_processing.long_format_transformer - WARNING - Required split column 'pp_split_6f_finish_secs' not found. Pace calculations involving it will result in NaN.
2025-07-01 05:13:21,471 - bris_handicapper.data_processing.long_format_transformer - INFO - Finished calculating Brohamer/Sartin pace figures.
2025-07-01 05:13:22,037 - bris_handicapper.data_processing.long_format_transformer - INFO - Saved past performance data to C:\Users\Larry\Documents\Bris\BrisHandicapper\data\processed\past_starts_long_format.parquet
2025-07-01 05:13:22,040 - bris_handicapper.main - INFO - =============================================
2025-07-01 05:13:22,041 - bris_handicapper.main - INFO - === Pipeline Finished Successfully      ===
2025-07-01 05:13:22,041 - bris_handicapper.main - INFO - =============================================
